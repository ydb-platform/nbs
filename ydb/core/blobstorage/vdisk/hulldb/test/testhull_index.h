#pragma once

#include "defs.h"
#include <ydb/core/blobstorage/vdisk/hulldb/hull_ds_all.h>

namespace NKikimr {
namespace NTest {

    //////////////////////////////////////////////////////////////////////////////////////////////
    // TLogoBlobsCmd
    //////////////////////////////////////////////////////////////////////////////////////////////
    struct TLogoBlobsCmd {
        TKeyLogoBlob Key;
        TMemRecLogoBlob MemRec;

        bool operator <(const TLogoBlobsCmd &cmd) const {
            return Key < cmd.Key;
        }
    };

    //////////////////////////////////////////////////////////////////////////////////////////////
    // TBarriersCmd
    //////////////////////////////////////////////////////////////////////////////////////////////
    struct TBarriersCmd {
        TKeyBarrier Key;
        TMemRecBarrier MemRec;

        bool operator <(const TBarriersCmd &cmd) const {
            return Key < cmd.Key;
        }
    };

    //////////////////////////////////////////////////////////////////////////////////////////////
    // TTabletCommand atomic update for a HullDs from a tablet
    //////////////////////////////////////////////////////////////////////////////////////////////
    class TTabletCommand {
    public:
        TMaybe<TLogoBlobsCmd> LogoBlobsCmd;
        TMaybe<TBarriersCmd> BarriersCmd;
    };

    //////////////////////////////////////////////////////////////////////////////////////////////
    // ITabletMock -- this class encapsultes test load for blobstorage from a tablet
    //////////////////////////////////////////////////////////////////////////////////////////////
    class ITabletMock {
    public:
        virtual const TTabletCommand &Next() = 0;
        virtual ~ITabletMock() = default;
    };

    //////////////////////////////////////////////////////////////////////////////////////////////
    // IHullDsIndexMock -- interface for test hull ds generator
    //////////////////////////////////////////////////////////////////////////////////////////////
    class IHullDsIndexMock {
    public:
        virtual TIntrusivePtr<THullDs> GenerateHullDs() = 0;
        virtual ~IHullDsIndexMock() = default;
    };


    //////////////////////////////////////////////////////////////////////////////////////////////
    // DS generators
    //////////////////////////////////////////////////////////////////////////////////////////////
    TIntrusivePtr<THullDs> GenerateDs_17Level_Logs();

} // NTest
} // NKikimr

